{% extends "base.html" %}
{% import "components/_user_header.html" as user_header %}

{% set primary_page = True %}
{% set page_name = "Chat" %}

{% block title %}Bitter - Chat{% endblock %}

{% block style %}
<link rel="stylesheet", type="text/css", href="{{ url_for('static', filename='styles/chat.css') }}">
{{ user_header.style() }}
{% endblock %}

{% block content %}
<div id="new-chat-popup" class="hidden">
    <div class="content">
        <h1>New chat</h1>
        <form id="new-chat-creation-form">
            <input type="text" id="new-chat-username-input" maxlength="24" placeholder="Username"></input>
            <input type="submit" name="post" value="Start chat" class="start-chat-button"></input>
        </form>
        <script>document.getElementById("new-chat-creation-form").reset()</script>
    </div>
    <svg class="transparent-button"><use href="../static/img/sprites.svg#icon-x"></use></svg>

    <script>
        let new_chat_popup = document.getElementById("new-chat-popup")
        new_chat_popup.addEventListener("click", () => {new_chat_popup.classList.toggle("hidden")})
        new_chat_popup.querySelector(".content").addEventListener("click", (event) => {event.stopPropagation()})
    </script>
</div>

<svg id="new-chat-button" class="transparent-button" title="New chat"><use href="../static/img/sprites.svg#icon-x"></use></svg>

<a id="chat-template" class="chat" href="{{ url_for('chat_conversation', username='erar') }}">
    {{ user_header.content(
        user_header_include_date_label = False,
        user_header_single_line = False,
        user_header_parent_class = "chat-user")
    }}
    <svg class="open-chat" title="Open chat"><use href="../static/img/sprites.svg#icon-back"></use></svg>
</a>

<script>
    document.getElementById("new-chat-button").addEventListener("click", () => {
        document.getElementById("new-chat-creation-form").reset()
        document.getElementById("new-chat-username-input").select()
        document.getElementById("new-chat-popup").classList.toggle("hidden")
    })
</script>
{% endblock %}

